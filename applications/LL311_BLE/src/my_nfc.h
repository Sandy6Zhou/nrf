/********************************************************************
**版权所有         深圳市几米物联有限公司
**文件名称:        my_nfc.h
**文件描述:        NFC 读卡管理模块头文件
**当前版本:        V1.0
**作    者:        Harrison Wu (wuyujiao@jimiiot.com)
**完成日期:        2026.01.15
*********************************************************************
** 功能描述:        1. 处理与 NFC 模块的 I2C 通讯
**                 2. 提供 NFC 电源控制接口 (P1.07)
**                 3. 实现定时轮询刷卡功能
*********************************************************************/

#ifndef _MY_NFC_H_
#define _MY_NFC_H_

/* 默认 NFC 工作时长 (秒) */
#define NFC_DEFAULT_WORK_TIME_S 30

/********************************************************************
**函数名称:  my_nfc_init
**入口参数:  tid      ---        指向线程 ID 变量的指针
**出口参数:  tid      ---        存储启动后的线程 ID
**函数功能:  初始化 NFC 相关的 I2C 设备与电源控制 GPIO 引脚，并启动 NFC 线程
**返 回 值:  0 表示成功，负值表示失败
*********************************************************************/
int my_nfc_init(k_tid_t *tid);

/********************************************************************
**函数名称:  my_nfc_pwr_on
**入口参数:  on       ---        true 开启，false 关闭
**出口参数:  无
**函数功能:  控制 NFC 模块的电源使能引脚 (P1.07)
**返 回 值:  0 表示成功，负值表示失败
*********************************************************************/
int my_nfc_pwr_on(bool on);

/********************************************************************
**函数名称:  my_nfc_start_work
**入口参数:  timeout_s ---        NFC 工作时长（秒），若为 0 则使用默认值
**出口参数:  无
**函数功能:  开启 NFC 电源并启动轮询刷卡任务，达到超时时间后自动关闭
**返 回 值:  0 表示成功启动
*********************************************************************/
int my_nfc_start_work(uint32_t timeout_s);

/********************************************************************
**函数名称:  my_nfc_stop_work
**入口参数:  无
**出口参数:  无
**函数功能:  提前停止 NFC 轮询任务并关闭电源
**返 回 值:  无
*********************************************************************/
void my_nfc_stop_work(void);

#endif /* _MY_NFC_H_ */
